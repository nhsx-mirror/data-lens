
This script scrapes the ONS database and inserts it into Elastic search. https://www.ons.gov.uk/peoplepopulationandcommunity/healthandsocialcare

It goes through each section `Causes Of Death`, `Child Health` etc and then scrapes any relevant information

An example of JSON data sent to elastic search ...

`{
          "source" : "Office for National Statistics",
          "source_url" : "https://www.ons.gov.uk/search",
          "ingest.timestamp" : "2021-02-19T14:42:56.742",
          "title" : "Coronavirus and homeschooling in Great Britain",
          "description" : "Analysis of homeschooling in Great Britain during the coronavirus (COVID-19) pandemic from the Opinions and Lifestyle Survey (OPN). Data relate to homeschooling from the COVID-19 module of the OPN, collected between 13 January and February 2021",
          "type" : "Dataset",
          "keywords" : [
            "home schooling",
            "learning from home",
            "education",
            "parents",
            "learning online"
          ],
          "vectors" : "[0.38597849011421204, -0.16443541646003723, -0.14488212764263153, -0.07615901529788971, -0.1281522512435913, -0.04671122878789902, 0.2217743694782257, 0.17329856753349304, -0.16169647872447968, 0.07290051132440567, 0.1915583610534668, 0.1059352308511734, -0.0006913267425261438, 0.21330954134464264, 0.024554956704378128, 0.2592794895172119, 0.0064620147459208965, -0.10978580266237259, -0.09900417178869247, 0.09018538147211075, -0.04786689952015877, -0.3438847064971924, -0.2156156748533249, 0.2032753974199295, 0.1808549165725708, -0.1426832526922226, -0.05826311185956001, 0.5110124945640564, -0.408706933259964, 0.16747774183750153, 0.011151846498250961, -0.0567508190870285, -0.255195289850235, 0.07999385893344879, 0.08549192547798157, 0.185286283493042, 0.053592924028635025, 0.06609531491994858, -0.024072367697954178, 0.07167823612689972, -0.08225482702255249, -0.07903636246919632, 0.006320157554000616, -0.11227577179670334, -0.005858918651938438, -0.2757989168167114, -0.07659954577684402, -0.004871440585702658, -0.36187437176704407, 0.24351894855499268, 0.03347078338265419, 0.06220794841647148, -0.13945138454437256, -0.12920939922332764, 0.05182671174407005, -0.06257162243127823, -0.13774387538433075, 0.043607331812381744, -0.19811290502548218, 0.32273030281066895, -0.1764555722475052, 0.17749755084514618, 0.13475486636161804, -0.15367230772972107, -0.0026157735846936703, 0.050630029290914536, -0.02812054194509983, -0.21747072041034698, 0.27478960156440735, -0.10311178117990494, -0.36000463366508484, 0.07546364516019821, -0.002175582805648446, -0.09087618440389633, 0.22864727675914764, -0.11454824358224869, -0.024235349148511887, 0.36857444047927856, 0.12908808887004852, -0.007124295458197594, 0.06338733434677124, 0.04622800275683403, 0.05018693581223488, 0.3265135884284973, -0.10718235373497009, 0.09491884708404541, -0.054307736456394196, -0.20525483787059784, 0.06689044088125229, -0.006724188569933176, 0.1917419284582138, -0.07008636742830276, 0.2772136628627777, -0.011548868380486965, 0.05799609422683716, 0.2823927700519562, -0.04101548716425896, -0.19282664358615875, -0.17980459332466125, 0.051024179905653, 0.16246938705444336, 0.22392667829990387, 0.1486312747001648, 0.3022100031375885, -0.25199297070503235, -0.23314885795116425, 0.21688252687454224, -0.36742129921913147, 0.07560737431049347, 0.401196151971817, 0.02692544274032116, -0.10490009188652039, -0.14700847864151, -0.25693073868751526, -0.3007875680923462, 0.015739381313323975, 0.08155283331871033, 0.32483142614364624, 0.18959598243236542, 0.13854438066482544, 0.06615744531154633, -0.12718109786510468, 0.04271462559700012, 0.12858037650585175, 0.055246029049158096, -0.05304828658699989, 0.07777294516563416, 0.1490183174610138, 0.3220255374908447, -0.0406341552734375, -0.2607484757900238, -0.26582393050193787, -0.04368840157985687, -0.20415686070919037, -0.06761046499013901, 0.24586591124534607, -0.48499688506126404, -0.046349164098501205, -0.698172926902771, 0.12664498388767242, 0.03674890846014023, 0.03367619216442108, 0.12164010107517242, -0.3467544913291931, -0.09440821409225464, -0.07187933474779129, -0.15309488773345947, 0.04875615984201431, 0.2977951765060425, -0.13906043767929077, -0.11744605749845505, -0.028385287150740623, -0.13248085975646973, -0.17369139194488525, -0.12400005012750626, 0.05018375813961029, -0.09191305935382843, -0.1865541934967041, 0.1539316624403, 0.12333228439092636, 0.11017026007175446, -0.07878050953149796, -0.18554899096488953, 0.18273888528347015, -0.04731837660074234, -0.13633017241954803, 0.12432408332824707, 0.06913642585277557, -0.06625999510288239, 0.09222304075956345, -0.2745991051197052, -0.06926702708005905, -0.15681074559688568, 0.28343069553375244, 0.3106192648410797, -0.0400337390601635, 0.1493278294801712, -0.04995013028383255, -0.2993343770503998, 0.16071878373622894, 0.02775477059185505, -0.19489648938179016, 0.09777501970529556, -0.0009893247624859214, -0.1241215318441391, -0.05384206026792526, 0.4355601668357849, -0.08493424206972122, 0.1619645655155182, 0.1368197649717331, 0.15715718269348145, -0.13368463516235352, 0.2568835914134979, 0.0773119255900383, -0.35397055745124817, 0.2586364448070526, -0.023378340527415276, -0.26867949962615967, 0.12244915962219238, 0.08380032330751419, 0.015976354479789734, 0.0009142307098954916, -0.1791316717863083, -0.10001906007528305, 0.02606562152504921, -0.10274997353553772, -0.0986538901925087, 0.10248669236898422, -0.12196946889162064, -0.10729064792394638, -0.14992763102054596, 0.0976850762963295, 0.2871033847332001, -0.028255965560674667, -0.23501604795455933, -0.1412072777748108, 0.10823871195316315, -0.0539931021630764, 0.11741232872009277, -0.16122889518737793, -0.3941521942615509, 0.09347359091043472, 0.11199434101581573, 0.11696925014257431, -0.03848850727081299, -0.04706420749425888, 0.015143558382987976, 0.01771136000752449, 0.32566511631011963, -0.3147888779640198, 0.06494243443012238, -0.05131026729941368, 0.05549871176481247, -0.23437592387199402, -0.12750618159770966, -0.1597757190465927, -0.12497715651988983, -0.09734655916690826, -0.21271856129169464, 0.03806452825665474, 0.08250722289085388, 0.016800876706838608, -0.02043372578918934, 0.10624349862337112, -0.2226237952709198, 0.061368830502033234, -0.040168292820453644, -0.003503328189253807, -0.23701927065849304, 0.40892449021339417, -0.12993325293064117, -0.027175486087799072, 0.6025795340538025, -0.2203063666820526, 0.39737987518310547, 0.028612732887268066, -0.07411308586597443, 0.11111882328987122, -0.4857170581817627, -0.19644856452941895, 0.20134183764457703, -0.061612773686647415, 0.40718522667884827, -0.06602520495653152, -0.009447622112929821, -0.04884657263755798, -0.20227017998695374, 0.16508987545967102, -0.6577134728431702, -0.0528525784611702, 0.2110794484615326, 0.08540211617946625, 0.1857401579618454, 0.19836702942848206, 0.08645184338092804, 0.017207516357302666, 0.1541815549135208, -0.11110609024763107, 0.24680349230766296, -0.28840896487236023, -0.0073181684128940105, 0.2239488810300827, 0.24204450845718384, 0.03631283715367317, 0.18234524130821228, 0.24933069944381714, 0.13210023939609528, 0.15185005962848663, -0.06767241656780243, -0.05251355096697807, 0.07171085476875305, 0.2226487249135971, -0.39134952425956726, -0.05244012549519539, 0.07272578030824661, 0.010918566957116127, 0.0018684291280806065, 0.4377441704273224, -0.1430378258228302, -0.009018456563353539, 0.31266191601753235, -0.1397751420736313, 0.08894727379083633, -0.07806658744812012, -0.170545756816864, 0.05548526346683502, 0.1172713190317154, 0.4899080991744995, 0.1095399558544159, 0.21649566292762756, 0.13677969574928284, 0.257763147354126, 0.048555999994277954, -0.15634185075759888, -0.21390055119991302, -0.06982912123203278, -0.07379210740327835, 0.32176685333251953, -0.19719825685024261, -0.05118834227323532, 0.11842022091150284, 0.1354197859764099, -0.04609905928373337, -0.1716974973678589, -0.039232607930898666, -0.16642408072948456, 0.18927642703056335, -0.08967801928520203, 0.041175298392772675, 0.0018561207689344883, -0.007003617472946644, -0.19952139258384705, 0.03857208415865898, 0.08426778018474579, -0.0951293557882309, 0.018251070752739906, 0.015448165126144886, 0.25585001707077026, -0.22198788821697235, 0.26631462574005127, 0.21808560192584991, 0.10682918131351471, 0.2709048092365265, -0.08957629650831223, -0.14671196043491364, -0.03528010472655296, 0.07374206185340881, 0.24186217784881592, -0.04456276819109917, 0.23864401876926422, 0.008961822837591171, 0.019328119233250618, -0.21937187016010284, 0.057170309126377106, -0.2668558657169342, 0.03318461403250694, 0.060685839504003525, 0.03642207384109497, 0.16919028759002686, -0.08079297840595245, -0.11516377329826355, -0.14692388474941254, 0.2627735733985901, -0.07836092263460159, -0.006877521052956581, -0.026866337284445763, 0.05650026723742485, 0.012120097875595093, -0.19291748106479645, -0.055434297770261765, 0.15924711525440216, -0.1925860345363617, 0.22865965962409973, 0.07847052812576294, -0.049490805715322495, 0.1306750774383545, 0.011806086637079716, 0.12065677344799042, -0.09686937928199768, -0.33984053134918213, -0.28123047947883606, -0.05489490553736687, 0.08665218204259872, -0.18219801783561707, -0.12559764087200165, -0.1709439903497696, -0.029020918533205986, -0.08325366675853729, 0.1411055326461792, -0.11202080547809601, -0.08763174712657928, 0.07837880402803421, -0.059961091727018356, -0.0707627460360527, 0.0343317873775959, -0.21872518956661224, -0.13926294445991516, -0.015019129030406475, 0.13254369795322418, 0.04197816923260689, -0.17891736328601837, 0.3084467649459839, -0.25833287835121155, -0.007316731382161379, -0.1143283024430275, -0.07575345039367676, -0.030168764293193817, -0.24500903487205505, 0.019456231966614723, -0.13339310884475708, -0.27189502120018005, -0.24067409336566925, 0.23652870953083038, 0.359116792678833, 0.22640201449394226, -0.31562116742134094, -0.10312864929437637, -0.0105993477627635, 0.021227454766631126, -0.1479140967130661, -0.15486468374729156, -0.18223915994167328, -0.03215378522872925, -0.022429192438721657, 0.26828309893608093, 0.05099170282483101, -0.5995603203773499, 0.002263993490487337, -0.059647344052791595, 0.2831907570362091, 0.07911540567874908, -0.26874852180480957, -0.07833917438983917, 0.25458815693855286, 0.06510672718286514, 0.050087664276361465, 0.26401272416114807, -0.03964422270655632, -0.1550140529870987, -0.1269650012254715, -0.034398071467876434, -0.11368977278470993, 0.24467213451862335, -0.5399264097213745, 0.0008659184095449746, -0.14538416266441345, 0.0349201001226902, -0.22975212335586548, 0.4478255808353424, -0.028254855424165726, 0.12950469553470612, 0.0514257438480854, 0.02615382708609104, 0.07117200642824173, -0.11923116445541382, -0.36798757314682007, -0.12089910358190536, -0.10202464461326599, -0.20697684586048126, 0.012553917244076729, -0.22336283326148987, 0.08779887109994888, -0.04011347144842148, 0.13037924468517303, 0.2498386949300766, -0.02260679006576538, -0.0565570630133152, 0.2816624045372009, 0.13068141043186188, 0.06982819736003876, 0.2039119154214859, 0.07944045960903168, 0.227960005402565, 0.5612793564796448, 0.22646461427211761, -0.11642087996006012, 0.2817041277885437, 0.17003081738948822, -0.2337002456188202, 0.1757536232471466, 0.13179892301559448, -0.0010015500010922551, 0.07999178022146225, 0.011694932356476784, 0.35975050926208496, 0.15757104754447937, 0.08333467692136765, 0.18901081383228302, -0.40020662546157837, 0.12018226087093353, -0.06600857526063919, 0.19387227296829224, -0.0025001296307891607, -0.10969449579715729, 0.15669824182987213, -0.15225328505039215, -0.12008819729089737, -0.05839638411998749, 0.2751353085041046, 0.22087621688842773, 0.14101162552833557, -0.060130465775728226, -0.1793214976787567, 0.1062508150935173, -0.26840367913246155, 0.3717690408229828, 0.16442404687404633, 0.2241126149892807, -0.025516290217638016, -0.06723574548959732, -0.22003643214702606, -0.2754501402378082, 0.12375115603208542, 0.1634456366300583, -0.20669463276863098, 0.08966659754514694, -0.2695315480232239, 0.2726821005344391, 0.19457168877124786, -0.2787391245365143, 0.17285111546516418, -0.19902434945106506, 0.15444763004779816, -0.19808192551136017, -0.33112356066703796, -0.12884993851184845, 0.3509574234485626, 0.46571341156959534, -0.14229734241962433, -0.06019381806254387, -0.12436024844646454, 0.011589107103645802, 0.141147643327713, -0.06317762285470963, -0.20464424788951874, 0.0027804498095065355, -0.2611408531665802, -0.19971255958080292, 0.049218639731407166, 0.34067314863204956, 0.017500553280115128, 0.21410390734672546, 0.11630673706531525, -0.1066124215722084, 0.025836674496531487, 0.28328651189804077, 0.1715075522661209, 0.0028111946303397417, 0.20762157440185547, 0.39255914092063904, 0.021209968253970146, 0.1185050830245018, -0.328226774930954, 0.18160952627658844, 0.2895277738571167, -0.1636272370815277, -0.23910093307495117, -8.99371337890625, 0.11045018583536148, -0.13096146285533905, -0.12016145884990692, -0.11580362170934677, 0.054770998656749725, 0.0882159024477005, 0.08542469888925552, 0.20173129439353943, 0.13290871679782867, -0.051621146500110626, -0.08602028340101242, 0.231959730386734, 0.006634681951254606, 0.10392303019762039, -0.15229792892932892, 0.183023139834404, 0.14739787578582764, 0.13295592367649078, 0.13808071613311768, -0.06202796846628189, 0.017901664599776268, -0.02617673948407173, 0.279599666595459, 0.09612585604190826, 0.28230762481689453, -0.18111984431743622, 0.05294372886419296, 0.17697934806346893, -0.04065999016165733, -0.23626846075057983, 0.1425226777791977, 0.015216673724353313, 0.17237316071987152, 0.029635785147547722, 0.12115133553743362, 0.15693847835063934, -0.16476213932037354, -0.14069147408008575, -0.28940990567207336, 0.0711882933974266, -0.24334996938705444, 0.19751763343811035, -0.17082534730434418, 0.11058592796325684, -0.15945452451705933, 0.1454707682132721, -0.1335766464471817, 0.1897255778312683, 0.10636766254901886, 0.28277719020843506, 0.0115400031208992, -0.16109317541122437, 0.277818500995636, -0.6093491911888123, 0.013660021126270294, -0.060036350041627884, 0.4342273771762848, 0.06715057045221329, -0.001317709218710661, -0.1597362905740738, -0.0056046368554234505, 0.0376737043261528, -0.3504476547241211, -0.18197743594646454, 0.11782599985599518, -0.42840874195098877, 6.029422365827486e-05, 0.11489545553922653, 0.0698685273528099, -0.24674351513385773, 0.05244353413581848, 0.24023470282554626, -0.23318086564540863, -0.20569837093353271, -0.23253412544727325, -0.19580721855163574, -0.1238747090101242, 0.13883019983768463, -0.11632053554058075, 0.0466572605073452, -0.04223395884037018, -0.0988326445221901, -0.22865785658359528, -0.23710231482982635, 0.021873224526643753, -0.15474307537078857, 0.5693106651306152, -0.10158045589923859, -0.22290289402008057, 0.15700796246528625, -0.1744256615638733, 0.13303694128990173, -0.11434387415647507, -0.2858034372329712, 0.1809867024421692, -0.05268053337931633, -0.07126996666193008, -0.07733942568302155, -0.002106742700561881, -0.016314959153532982, 0.09932001680135727, -0.062352150678634644, -0.1229310855269432, 0.1656980663537979, -0.01988990046083927, 0.0454939566552639, -0.28859591484069824, -0.2319817990064621, -0.0392116941511631, -0.06934181600809097, 0.13813869655132294, 0.050342854112386703, -0.01364315114915371, -0.00978002231568098, 0.2431555986404419, 0.4332329332828522, -0.14651145040988922, 0.2805401682853699, 0.19165849685668945, 0.19470003247261047, -0.17611999809741974, 0.39627692103385925, -0.09584032744169235, 0.05752594396471977, 0.19635355472564697, 0.18722200393676758, -0.30391353368759155, 0.3549940288066864, 0.08098240196704865, 0.4286709129810333, 0.06672191619873047, -0.03538889065384865, 0.1822841465473175, -0.024698087945580482, 0.046793077141046524, 0.09185396134853363, 0.05531039088964462, 0.0352603942155838, -0.33707407116889954, -0.18394622206687927, -0.09069891273975372, 0.14388041198253632, 0.24727106094360352, 0.24327750504016876, -0.16412681341171265, -0.21610061824321747, -0.4820003807544708, 0.06618385761976242, -0.053161945194005966, 0.033201731741428375, 0.189789280295372, 0.01836271584033966, -0.04471290484070778, 0.18416057527065277, 0.16818678379058838, 0.07809954881668091, -0.01796581596136093, -0.029620762914419174, 0.024527186527848244, -0.06805846095085144, 0.16491805016994476, 0.0884251594543457, 0.10530600696802139, -0.17960382997989655, 0.13258913159370422, 0.024168414995074272, -0.072385773062706, -0.08162764459848404, -0.15992562472820282, -0.06018536165356636, -0.18047887086868286, 0.007268691901117563, -0.036586225032806396, 0.1647241711616516, -0.14213907718658447, 0.07389954477548599, 0.21388447284698486, -0.20032955706119537, -0.01747868023812771, -0.06505118310451508, 0.32709237933158875, -0.1075495034456253, -0.4174921214580536, -0.03562234714627266, 0.07551003992557526, -0.13543866574764252, 0.07117964327335358, -0.05740324780344963, -0.06104268506169319, -0.39079031348228455, -0.3591000437736511, -0.07071512192487717, 0.1452203094959259, 0.0850721076130867, 0.21278244256973267, -0.2657749354839325, 0.07915667444467545, -0.1777634173631668, 0.17228689789772034, -0.01568429544568062, -0.09510339051485062, 0.19323286414146423, -0.09403937309980392, -0.3226683437824249, -0.04135041683912277, -0.15757790207862854, 0.03031921200454235, 0.22463983297348022, -0.2396496683359146, -0.15329092741012573]",
          "url" : "https://www.ons.gov.uk/redir/eyJhbGciOiJIUzI1NiJ9.eyJpbmRleCI6MSwicGFnZVNpemUiOjEwMDAwLCJwYWdlIjoxLCJ1cmkiOiIvcGVvcGxlcG9wdWxhdGlvbmFuZGNvbW11bml0eS9lZHVjYXRpb25hbmRjaGlsZGNhcmUvZGF0YXNldHMvY29yb25hdmlydXNhbmRob21lc2Nob29saW5naW5ncmVhdGJyaXRhaW4iLCJsaXN0VHlwZSI6ImRhdGFsaXN0In0.NGb74pwqT7PfueNxZW4yJLS-rXabFmljJugoeCsWHSo",
          "contact" : "Tim Vizard",
          "release_date" : "2021-02-19",
          "resources" : [
            {
              "title" : "2021",
              "url" : "https://www.ons.gov.uk/file?uri=/peoplepopulationandcommunity/educationandchildcare/datasets/coronavirusandhomeschoolingingreatbritain/2021/homeschoolingreftablesfinal.xlsx"
            },
            {
              "title" : "2020",
              "url" : "https://www.ons.gov.uk/file?uri=/peoplepopulationandcommunity/educationandchildcare/datasets/coronavirusandhomeschoolingingreatbritain/2020/coronavirusandhomeschoolingreferencetables.xlsx"
            }
          ]
        }`


